#!/usr/bin/env ruby

$LOAD_PATH.unshift(File.expand_path(File.dirname(__FILE__) + "/../lib"))

require 'scanny'

runner = Scanny::Runner.new

config_param = ARGV.detect {|arg| arg =~ /-config=.*/}
runner.config = config_param.split("=")[1] if config_param
ARGV.delete config_param

ARGV.each do |arg|
  Dir.glob(arg).each { |file| runner.check_file(file) }
end

runner.issues.each {|issue| puts issue}

puts "\nFound #{runner.issues.size} issues."

exit runner.issues.size
