#!/usr/bin/env ruby

require "rubygems"
require File.expand_path(File.dirname(__FILE__) + "/../lib/scanny")

runner = Scanny::Runner.new
issues = []

ARGV.each do |arg|
  Dir[arg].each do |file|
    begin
      issues += runner.check_file(file)
    rescue SyntaxError => e
      $stderr.puts "Can't parse #{file} as Ruby file."
      exit 2
    end
  end
end

issues.each { |i| puts i }
puts

if issues.empty?
  puts "Found no issues."
  exit 0
else
  puts "Found #{issues.size} issues."
  exit 1
end
